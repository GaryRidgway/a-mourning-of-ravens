function placeFirstStanza(e){return mourn.trackers.anchor=document.createElement("div"),mourn.trackers.anchorStyle=mourn.trackers.anchor.style,mourn.trackers.anchor.setAttribute("id","anchor"),mourn.trackers.startStanza=placeStanza(e),mourn.trackers.startStanza.setAttribute("id","anchor-stanza"),mourn.config.poemContainer.append(mourn.trackers.anchor),addNonRenderedConnector(mourn.trackers.startStanza,-1),addNonRenderedConnector(mourn.trackers.startStanza,1),mourn.trackers.startStanza}function placeStanza(e,t=null){const n=e.cloneNode(!0);return n.setAttribute("uid",UID()),null!==t?t.leftOffset&&t.topOffset&&(t.leftOffset<0&&t.topOffset<0?mourn.trackers.anchor.prepend(n):mourn.trackers.anchor.append(n),n.style.setProperty("--left-offset",parseFloat(t.leftOffset)),n.style.setProperty("--top-offset",parseFloat(t.topOffset))):mourn.trackers.anchor.append(n),n}function render(e,t=1){const n=parseInt(e.dataset.stanzaNumber),r=fetchStagedStanza(n+t),o=t<0?r:e,a=fetchRenderedStanza(n,getUID(e));let s={leftOffset:0,topOffset:0};s.leftOffset=t*parseFloat(o.dataset.leftOffset),s.topOffset=t*parseFloat(o.dataset.topOffset);const c=a.style.getPropertyValue("--left-offset");c.length>0&&(s.leftOffset=parseFloat(c)+s.leftOffset);const f=a.style.getPropertyValue("--top-offset");f.length>0&&(s.topOffset=parseFloat(f)+s.topOffset);return{stanza:placeStanza(r,s),options:s}}function addNonRenderedConnector(e,t){const n=getUID(e)+"["+t+"]",r=isInViewport(fetchConnector(e,t));mourn.trackers.nonRenderedConnectors[n]={stanza:e,direction:t,direction:t,visible:r}}function cascadeRender(e){if(void 0!==mourn.trackers.anchor){if(Object.keys(mourn.trackers.nonRenderedConnectors).length>0){let t=checkForVisibleConnectors();if(t.length>0){let n=0;for(;t.length>0&&cascadeContinueIterating(n,e)&&(t.forEach((e=>{const t=mourn.trackers.nonRenderedConnectors[e],n=fetchConnector(t.stanza,t.direction);if(isInViewport(n)){addNonRenderedConnector(render(t.stanza,t.direction).stanza,t.direction),delete mourn.trackers.nonRenderedConnectors[e]}else t.visible=!1,console.log('Set connector "'+e+'" `visible` to `false`.')})),t=checkForVisibleConnectors(),n++,!(n>=200)););}}else console.error("There are no non-rendered elements.")}else console.error("There is no anchor stanza to cascade from.")}function cascadeContinueIterating(e,t=null){if(null!==t){if(Object.hasOwn(t,"iterationMax")){return e<t.iterationMax}return!0}return!0}function placePoemCenter(){const e=document.createElement("div");e.classList.add("center-dot"),mourn.config.poemContainer.append(e)}